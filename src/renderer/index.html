<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; font-src 'self' data:;" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ClaudeBox</title>
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <div class="app-shell">
      <aside class="sidebar">
        <div class="sidebar__branding">
          <div class="sidebar__title">
            <pre class="ascii-logo"></pre>
          </div>
          <div class="sidebar__divider"></div>
        </div>
        <div class="sidebar__new-session-label">New Session</div>
        <div class="sidebar__actions">
          <div>
            <button id="newClaude" class="sidebar__action sidebar__action--claude">
              <img src="/images/claudecode-icon.svg" alt="Claude" class="button-icon"/>
              <span>Claude Code</span>
            </button>
            <button id="newCodex" class="sidebar__action sidebar__action--codex">
              <img src="/images/codex-icon.svg" alt="Codex" class="button-icon"/>
              <span>Codex</span>
            </button>
          </div>
          <div>
            <button id="newOpenCode" class="sidebar__action sidebar__action--opencode">
              <img src="/images/opencode-logo.svg" alt="OpenCode" class="button-icon"/>
              <span>OpenCode</span>
            </button>
            <button id="newGemini" class="sidebar__action sidebar__action--gemini">
              <img src="/images/gemini-icon.svg" alt="Gemini" class="button-icon"/>
              <span>Gemini</span>
            </button>
          </div>
          <div>
            <button id="newTerminal" class="sidebar__action sidebar__action--terminal">
              <img src="/images/terminal-icon.svg" alt="Terminal" class="button-icon"/>
              <span>Terminal</span>
            </button>
          </div>
          <div class="sidebar__dir-input-wrapper">
            <label for="sessionDir" class="sidebar__dir-label">Directory</label>
            <div class="sidebar__dir-input-group">
              <input
                type="text"
                id="sessionDir"
                class="sidebar__dir-input"
                placeholder="Leave empty for current directory"
              />
              <button id="browseDirBtn" class="sidebar__dir-browse" title="Browse for directory">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                  <path d="M3 6C3 4.89543 3.89543 4 5 4H9L11 6H19C20.1046 6 21 6.89543 21 8V18C21 19.1046 20.1046 20 19 20H5C3.89543 20 3 19.1046 3 18V6Z" fill="currentColor"/>
                  <path d="M3 6C3 4.89543 3.89543 4 5 4H9L11 6H19C20.1046 6 21 6.89543 21 8V18C21 19.1046 20.1046 20 19 20H5C3.89543 20 3 19.1046 3 18V6Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </button>
            </div>
          </div>
          <div class="sidebar__branch-wrapper">
            <label class="sidebar__branch-label">Branch</label>
            <div class="sidebar__branch-controls">
              <div class="sidebar__branch-selector-wrapper">
                <button id="branchSelector" class="sidebar__branch-selector" title="Select git branch">
                  <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="6" y1="3" x2="6" y2="15"></line>
                    <circle cx="18" cy="6" r="3"></circle>
                    <circle cx="6" cy="18" r="3"></circle>
                    <path d="M18 9a9 9 0 0 1-9 9"></path>
                  </svg>
                  <span id="branchName">Not a git repo</span>
                  <svg class="branch-chevron" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="6 9 12 15 18 9"></polyline>
                  </svg>
                </button>
                <div id="branchDropdown" class="sidebar__branch-dropdown hidden">
                  <div class="branch-dropdown__header">
                    <input type="text" id="newBranchInput" class="branch-dropdown__input" placeholder="New branch name..." />
                    <button id="createBranchBtn" class="branch-dropdown__create-btn" title="Create new branch">
                      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="12" y1="5" x2="12" y2="19"></line>
                        <line x1="5" y1="12" x2="19" y2="12"></line>
                      </svg>
                    </button>
                  </div>
                  <div class="branch-dropdown__divider"></div>
                  <div id="branchList" class="branch-dropdown__list"></div>
                </div>
              </div>
              <button id="branchModeToggle" class="sidebar__branch-mode-toggle" title="Toggle branch mode">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
                </svg>
              </button>
            </div>
          </div>
        </div>
        <div class="sidebar__prompts-section">
          <button id="quickPromptsBtn" class="sidebar__quick-prompts-btn">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
            </svg>
            <span>Quick Prompts</span>
            <svg class="prompts-chevron" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <polyline points="6 9 12 15 18 9"></polyline>
            </svg>
          </button>
          <div id="quickPromptsDropdown" class="sidebar__quick-prompts-dropdown hidden">
            <div id="builtInPrompts">
              <button class="quick-prompt-item" data-prompt="debug">
                <span class="quick-prompt-label">Debug an Issue</span>
                <span class="quick-prompt-desc">Systematic debugging with logs</span>
              </button>
              <button class="quick-prompt-item" data-prompt="merge">
                <span class="quick-prompt-label">Merge Branch</span>
                <span class="quick-prompt-desc">Merge into main & clean up</span>
              </button>
              <button class="quick-prompt-item" data-prompt="handoff">
                <span class="quick-prompt-label">Handoff Summary</span>
                <span class="quick-prompt-desc">Generate branch summary</span>
              </button>
              <button class="quick-prompt-item" data-prompt="analysis">
                <span class="quick-prompt-label">Project Analysis</span>
                <span class="quick-prompt-desc">Initial codebase overview</span>
              </button>
            </div>
            <div id="customPromptsContainer"></div>
            <div class="prompts-divider"></div>
            <button id="managePromptsBtn" class="manage-prompts-btn">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="3"></circle>
                <path d="M12 1v6m0 6v6m-9-9h6m6 0h6"></path>
              </svg>
              <span>Manage Custom Prompts</span>
            </button>
          </div>
        </div>
        <div class="sidebar__list-header">Sessions</div>
        <ul id="sessionList" class="session-list"></ul>
        <button id="sidebarToggle" class="sidebar__toggle" aria-label="Toggle sidebar">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="15 18 9 12 15 6"></polyline>
          </svg>
        </button>
      </aside>
      <div id="sidebarResizer" class="sidebar-resizer"></div>
      <main class="workspace">
        <button id="sidebarToggleWorkspace" class="sidebar__toggle sidebar__toggle--workspace" aria-label="Toggle sidebar" style="display: none;">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="9 18 15 12 9 6"></polyline>
          </svg>
        </button>
        <div class="window-controls">
          <button id="minimizeBtn" class="window-controls__button window-controls__button--minimize" aria-label="Minimize">
            <svg width="12" height="12" viewBox="0 0 12 12">
              <rect x="0" y="5" width="12" height="2" fill="currentColor"/>
            </svg>
          </button>
          <button id="maximizeBtn" class="window-controls__button window-controls__button--maximize" aria-label="Maximize">
            <svg width="12" height="12" viewBox="0 0 12 12">
              <rect x="1" y="1" width="10" height="10" fill="none" stroke="currentColor" stroke-width="1.5"/>
            </svg>
          </button>
          <button id="closeBtn" class="window-controls__button window-controls__button--close" aria-label="Close">
            <svg width="12" height="12" viewBox="0 0 12 12">
              <path d="M1 1L11 11M11 1L1 11" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            </svg>
          </button>
        </div>
        <section class="workspace__terminal">
          <div id="terminal" class="terminal-host"></div>
          <div id="emptyState" class="terminal-empty"></div>
        </section>
      </main>
    </div>

    <!-- Custom Prompts Manager Modal -->
    <div id="customPromptsModal" class="modal hidden">
      <div class="modal__overlay"></div>
      <div class="modal__content">
        <div class="modal__header">
          <h2>Manage Custom Prompts</h2>
          <button id="closeModalBtn" class="modal__close">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>
        </div>
        <div class="modal__body">
          <div id="customPromptsList" class="custom-prompts-list"></div>
          <button id="addPromptBtn" class="add-prompt-btn">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
              <line x1="12" y1="5" x2="12" y2="19"></line>
              <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
            <span>Add New Prompt</span>
          </button>
        </div>
      </div>
    </div>

    <!-- Prompt Editor Modal -->
    <div id="promptEditorModal" class="modal hidden">
      <div class="modal__overlay"></div>
      <div class="modal__content modal__content--large">
        <div class="modal__header">
          <h2 id="editorModalTitle">Add Custom Prompt</h2>
          <button id="closeEditorBtn" class="modal__close">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>
        </div>
        <div class="modal__body">
          <div class="form-group">
            <label for="promptName">Prompt Name</label>
            <input type="text" id="promptName" placeholder="e.g., Code Review" />
          </div>
          <div class="form-group">
            <label for="promptDescription">Short Description</label>
            <input type="text" id="promptDescription" placeholder="e.g., Review code for best practices" />
          </div>
          <div class="form-group">
            <label for="promptContent">Prompt Content</label>
            <textarea id="promptContent" rows="12" placeholder="Enter the full prompt text that will be sent to the AI..."></textarea>
          </div>
          <div class="modal__footer">
            <button id="cancelPromptBtn" class="btn btn--secondary">Cancel</button>
            <button id="savePromptBtn" class="btn btn--primary">Save Prompt</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Update Notification Toast -->
    <div id="updateNotification" class="update-toast hidden">
      <div class="update-toast__content">
        <div class="update-toast__icon">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="10"></circle>
            <polyline points="12 6 12 12 16 14"></polyline>
          </svg>
        </div>
        <div class="update-toast__info">
          <div id="updateTitle" class="update-toast__title">Update Available</div>
          <div id="updateMessage" class="update-toast__message">Version 1.2.0 is ready to download</div>
        </div>
        <div class="update-toast__actions">
          <button id="downloadUpdateBtn" class="update-toast__btn update-toast__btn--primary">Download</button>
          <button id="dismissUpdateBtn" class="update-toast__btn update-toast__btn--secondary">Later</button>
        </div>
      </div>
      <div id="updateProgress" class="update-toast__progress hidden">
        <div class="update-toast__progress-bar">
          <div id="updateProgressFill" class="update-toast__progress-fill" style="width: 0%"></div>
        </div>
        <div id="updateProgressText" class="update-toast__progress-text">Downloading... 0%</div>
      </div>
    </div>

    <script type="module" src="./renderer.js"></script>
  </body>
</html>
